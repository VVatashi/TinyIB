!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=luxon},function(t,e,n){"use strict";n.r(e);var o=function(){function t(){}return t.prototype.onReady=function(){},t.prototype.onPostInsert=function(t){},t}();function r(t){return document.getElementById(t)}function i(t,e){return void 0===e&&(e=document),e.querySelector(t)}function a(t,e){return void 0===e&&(e=document),e.querySelectorAll(t)}var u,c=(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(){var e=t.call(this)||this;return e.original_src="",e}return c(e,t),e.prototype.onReady=function(){var t=this,e=r("captchaimage");e&&(this.original_src=e.src,e.addEventListener("click",function(){return t.reload()}))},e.prototype.reload=function(){var t=r("captcha");return t.value="",t.focus(),r("captchaimage").src=this.original_src+"#"+(new Date).getTime(),!1},e}(o),f=n(0);function l(t,e){void 0===e&&(e=null);var n=("; "+document.cookie).split("; "+t+"=");if(2===n.length){var o=n.pop().split(";").shift();return decodeURIComponent(o)}return e}function p(t,e,n){var o=encodeURIComponent(e),r=n.toUTCString();document.cookie=t+"="+o+"; path=/; expires="+r}var _=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},d=function(){function t(){}return t.format=function(t,e){var n=e.time_locale,o=e.time_locale_custom_value,r=e.time_zone,i=e.time_zone_fixed_offset,a=e.time_format,u=e.time_format_custom_value;if("custom"===n&&(t=t.setLocale(o)),"fixed"===r){var c="UTC"+(i>=0?"+":"")+i.toString();t=t.setZone(c)}if("custom"===a)return t.toFormat(u);var s=_({},f.DateTime.DATETIME_FULL_WITH_SECONDS);return s.timeZone=void 0,s.timeZoneName=void 0,t.toLocaleString(s)},t}(),v=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=function(t){function e(){var e=t.call(this)||this;return e.settings=JSON.parse(l("tinyib_settings","{}")),e}return v(e,t),e.prototype.onReady=function(){for(var t=a(".post-header__datetime"),e=0;e<t.length;++e)this.correctTime(t[e])},e.prototype.onPostInsert=function(t){var e=i(".post-header__datetime",t);e&&this.correctTime(e)},e.prototype.correctTime=function(t){var e=t.getAttribute("datetime");if(e){var n=f.DateTime.fromISO(e);t.innerHTML=d.format(n,this.settings)}},e}(o),y=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),h=function(t){function e(){return t.call(this)||this}return y(e,t),e.prototype.onReady=function(){var t=this;this.setupHandlers(),setTimeout(function(){var e=r("de-panel-buttons");e&&a(".de-panel-button",e).length>1&&t.setupHandlers()},1e3)},e.prototype.onPostInsert=function(t){var e=this;setTimeout(function(){for(var n=a(".file-info__link, .thumbnail, .original",t),o=function(t){var o=Number(n[t].getAttribute("data-id"));n[t].addEventListener("click",function(t){return e.expandFile(t,o)})},r=0;r<n.length;++r)o(r)},100)},e.prototype.setupHandlers=function(){for(var t=this,e=a(".file-info__link, .thumbnail, .original"),n=function(n){var o=Number(e[n].getAttribute("data-id"));e[n].addEventListener("click",function(e){return t.expandFile(e,o)})},o=0;o<e.length;++o)n(o)},e.prototype.scrollIntoView=function(t){for(var e=window.scrollY||window.pageYOffset,n=window.innerHeight,o=0,r=t.offsetHeight,i=t;i&&"BODY"!==i.tagName;i=i.offsetParent)o+=i.offsetTop;e+n<o+r?t.scrollIntoView(!1):o<e&&t.scrollIntoView(!0)},e.prototype.expandFile=function(t,e){var n=this;if(void 0===t||void 0===t.which||1===t.which){t&&t.preventDefault();var o=r("thumbnail_wrapper_"+e),i=r("original_wrapper_"+e);if("true"!==o.getAttribute("data-expanded")){o.setAttribute("data-expanded","true");var a=r("expand_"+e);i.innerHTML=decodeURIComponent(a.textContent),i.style.visibility="hidden",setTimeout(function(){o.style.display="none",i.style.visibility="visible",i.style.display="",n.scrollIntoView(i)},100)}else{o.setAttribute("data-expanded","false"),i.style.display="none",i.innerHTML="",o.style.display="";var u=r("thumbnail_"+e);this.scrollIntoView(u)}return!1}return!0},e}(o),g=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),b=function(t){function e(){return t.call(this)||this}return g(e,t),e.prototype.onReady=function(){var t=this,e={markup_quote:function(){return t.insertMarkup("\n>","\n")},markup_b:function(){return t.insertBBCode("b")},markup_i:function(){return t.insertBBCode("i")},markup_u:function(){return t.insertBBCode("u")},markup_s:function(){return t.insertBBCode("s")},markup_sup:function(){return t.insertBBCode("sup")},markup_sub:function(){return t.insertBBCode("sub")},markup_spoiler:function(){return t.insertBBCode("spoiler")},markup_code:function(){return t.insertBBCode("code")},markup_rp:function(){return t.insertBBCode("rp")}};Object.keys(e).forEach(function(t){var n=r(t);n&&n.addEventListener("click",e[t])})},e.prototype.insertMarkup=function(t,e){var n=r("message"),o=n.value,i=n.selectionStart,a=n.selectionEnd;return n.value=[o.substring(0,i),t,o.substring(i,a),e,o.substring(a)].join(""),n.focus(),n.selectionStart=i+t.length,n.selectionEnd=i+t.length+(a-i),!1},e.prototype.insertBBCode=function(t){return this.insertMarkup("["+t+"]","[/"+t+"]")},e}(o),w=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),O=function(t){function e(){return t.call(this)||this}return w(e,t),e.prototype.onReady=function(){var t=i('input[name="name"]');t&&(t.value=l("tinyib_name",""),t.addEventListener("change",function(){var e=new Date;e.setTime(e.getTime()+31536e6),p("tinyib_name",t.value,e)}));var e=r("newpostpassword");if(e){var n=l("tinyib_password");e.value=n;var o=r("deletepostpassword");o&&(o.value=n),e.addEventListener("change",function(){var t=new Date;t.setTime(t.getTime()+31536e6),p("tinyib_password",e.value,t)})}},e}(o),k=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),T=function(t){function e(){return t.call(this)||this}return k(e,t),e.prototype.onReady=function(){var t=this,e=window.location.hash;if(e){var n=e.match(/^#q\d+$/i);if(null!==n){var o=Number(n[0].substr(2));this.quotePost(o)}}for(var r=a(".post-header__reflink"),i=function(e){var n=Number(r[e].getAttribute("data-id"));r[e].addEventListener("click",function(){return t.quotePost(n)})},u=0;u<r.length;++u)i(u)},e.prototype.quotePost=function(t){var e=r("message");return e.value=e.value+">>"+t+"\n",e.focus(),!1},e}(o),L=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),P=function(t){function e(){var e=t.call(this)||this;return e.settings=JSON.parse(l("tinyib_settings","{}")),e}return L(e,t),e.prototype.getFormValues=function(){var t=i('input[name="time_locale"]:checked'),e=r("time_locale_custom_value"),n=i('input[name="time_format"]:checked'),o=r("time_format_custom_value"),a=i('input[name="time_zone"]:checked'),u=r("time_zone_fixed_offset");return{time_locale:t.value,time_locale_custom_value:e.value,time_zone:a.value,time_zone_fixed_offset:Number(u.value),time_format:n.value,time_format_custom_value:o.value}},e.prototype.onReady=function(){var t=this,e=r("settings_form");if(e){var n,o=r("status"),a=r("time_locale_custom"),u=r("time_locale_custom_value"),c=r("time_format_custom"),s=r("time_format_custom_value"),l=r("time_zone_fixed"),_=r("time_zone_fixed_offset"),v=r("time_current_format");if(this.settings.time_locale)(n=i('input[name="time_locale"][value="'+this.settings.time_locale+'"]'))&&(n.checked=!0);if(this.settings.time_format)(n=i('input[name="time_format"][value="'+this.settings.time_format+'"]'))&&(n.checked=!0);if(this.settings.time_zone)(n=i('input[name="time_zone"][value="'+this.settings.time_zone+'"]'))&&(n.checked=!0);u.value=this.settings.time_locale_custom_value||"",s.value=this.settings.time_format_custom_value||"",_.value=(this.settings.time_zone_fixed_offset||0).toString(),a&&u&&u.addEventListener("click",function(t){a.checked=!0}),c&&s&&s.addEventListener("click",function(t){c.checked=!0}),l&&_&&_.addEventListener("click",function(t){l.checked=!0}),e.addEventListener("submit",function(e){e.preventDefault();var n=new Date;n.setTime(n.getTime()+31536e6);var r=t.getFormValues();return p("tinyib_settings",JSON.stringify(r),n),o&&(o.innerHTML="",setTimeout(function(){o.innerHTML="Settings saved."},1e3/3)),!1});var m=function(){if(v)try{var e=f.DateTime.fromJSDate(new Date),n=t.getFormValues();v.innerHTML=d.format(e,n)}catch(t){v.innerHTML="Invalid format"}};m(),setInterval(m,1e3)}},e}(o),E=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),j=function(t){function e(){var e=t.call(this)||this;e.styles={};for(var n=a("link[title]"),o=0;o<n.length;++o){var r=n[o],i=r.title,u=r.getAttribute("href");e.styles[i]=u,r.remove()}var c=l("tinyib_style","Futaba");return e.setStyle(c),e}return E(e,t),e.prototype.onReady=function(){var t=this,e=r("style-switcher");if(e){for(var n=Object.keys(this.styles),o=0;o<n.length;++o){var i=n[o];this.styles[i];e.innerHTML+='<option class="style-switcher__option" value="'+i+'">'+i+"</option>"}e.addEventListener("change",function(){t.setStyle(e.value)})}},e.prototype.setStyle=function(t){var e=i("head");if(e){var n=i("link[data-selected]");if(n){if(n.title===t)return;n.remove()}var o=this.styles[t];e.innerHTML+='<link rel="stylesheet" type="text/css" href="'+o+'" data-selected="true" />';var r=new Date;r.setTime(r.getTime()+31536e6),p("tinyib_style",t,r)}},e}(o),x={};x.Captcha=new s,x.CorrectTime=new m,x.ExpandFile=new h,x.FormMarkup=new b,x.FormSave=new O,x.QuotePost=new T,x.Settings=new P,x.StyleSwitcher=new j;var S=new MutationObserver(function(t){t.forEach(function(t){for(var e=function(e){var n=t.addedNodes[e];if(n.nodeType!==Node.ELEMENT_NODE)return"continue";var o=n;o.classList.contains("post")&&Object.keys(x).forEach(function(t){x[t].onPostInsert(o)})},n=0;n<t.addedNodes.length;++n)e(n)})});document.addEventListener("DOMContentLoaded",function(){S.observe(document.body,{childList:!0,subtree:!0}),Object.keys(x).forEach(function(t){x[t].onReady()})})}]);