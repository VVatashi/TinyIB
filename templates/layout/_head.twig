{% macro style(title, filename, relation) %}
  <link rel="{{ relation|default('alternate stylesheet') }}" type="text/css" title="{{ title }}"
    href="{{ base_url }}/css/{{ filename }}.css?mtime={{ mtime('css/' ~ filename ~ '.css') }}" />
{% endmacro %}

{% macro script(filename) %}
  <script src="{{ base_url }}/js/{{ filename }}.js?mtime={{ mtime('js/' ~ filename ~ '.js') }}"></script>
{% endmacro %}

{% import _self as self %}

<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>{{ constant('TINYIB_BOARDDESC') }}</title>

<link rel="shortcut icon" href="{{ base_url }}/favicon.ico" />
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Noto+Serif:400,700|Roboto:300,400,700&amp;subset=cyrillic" rel="stylesheet">

{{ self.style('2watch',    '2watch') }}
{{ self.style('Futaba',    'futaba') }}
{{ self.style('Lime',      'lime') }}
{{ self.style('Nocturnal', 'nocturnal') }}
{{ self.style('Quartz',    'quartz', 'stylesheet') }}
{{ self.style('Synthwave', 'synthwave') }}

{% if constant('TINYIB_GTM') %}
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','{{ constant('TINYIB_GTM') }}');</script>
  <!-- End Google Tag Manager -->
{% endif %}

{{ self.script('vendor/Dollchan_Extension_Tools.user') }}
{{ self.script('vendor/promise-polyfill.min') }}
{{ self.script('vendor/fetch.min') }}
{{ self.script('vendor/luxon.min') }}
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.21/dist/vue.js"></script>

<script>window.baseUrl = '{{ base_url|raw }}';</script>

{{ self.script('index') }}

{% if constant('TINYIB_CAPTCHA') == 'recaptcha' %}
  <script src="https://www.google.com/recaptcha/api.js?render={{ constant('TINYIB_RECAPTCHA_SITE') }}"></script>
  <script>
    grecaptcha.ready(() => {
      const container = document.querySelector('footer');
      container.style.minHeight = '45px';

      const captcha = document.querySelector('.grecaptcha-badge');
      captcha.style.position = 'absolute';
      captcha.style.top = 0;
      captcha.style.bottom = 'unset';
      captcha.style.left = 'unset';
      captcha.style.right = 0;
      captcha.style.transform = 'scale(0.75)';
      container.appendChild(captcha);
    });
  </script>
{% endif %}
